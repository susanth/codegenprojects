
pipeline {
    agent any
    environment {
        BRANCHNAME = "PROD_12345"
        DEPLOYENV = "PROD"
        VERSION = "1.0.0"
    }
    stages {
        stage('PROD') {
            when {
                expression {
                    return BRANCHNAME.endsWith("12345") && BRANCHNAME.startsWith("PROD")
                }
            }
            steps {
                sh 'curl -X POST http://localhost:8080/updateUserStatus -d version=${VERSION} -d deployenv=${DEPLOYENV}'
            }
        }
        stage('BUGFIX') {
            when {
                expression {
                    return BRANCHNAME.endsWith("67890") && BRANCHNAME.startsWith("BUGFIX")
                }
            }
            steps {
                sh 'curl -X POST http://localhost:8080/updateUserStatus -d version=${VERSION} -d deployenv=${DEPLOYENV}'
            }
        }
        stage('CUSTOMER') {
            when {
                expression {
                    return BRANCHNAME.endsWith("09876") && BRANCHNAME.startsWith("CUSTOMER")
                }
            }
            steps {
                sh 'curl -X POST http://localhost:8080/updateUserStatus -d version=${VERSION} -d deployenv=${DEPLOYENV}'
            }
        }
    }
}